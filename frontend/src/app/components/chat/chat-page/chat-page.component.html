<div class="chat-wrapper" [class.chat-opened]="selectedChat">
  <app-chat-sidebar
    [chats]="chats"
    [selectedChat]="selectedChat"
    [isOpen]="true"
    (chatSelected)="openChat($event)"
    (chatDeleted)="onChatDeleted($event)"
  ></app-chat-sidebar>

  <main class="chat-window" *ngIf="selectedChat; else emptyState">
    <header class="chat-header">
      <div class="header-left">
        <button class="back-btn" (click)="closeChat()">
          <i class="icon-arrow-left">‚Üê</i>
        </button>

        <div class="avatar-wrapper">
          <div class="avatar">{{ getChatName(selectedChat)[0] }}</div>
          <div class="status-indicator online"></div>
        </div>

        <div class="header-info">
          <div class="name">{{ getChatName(selectedChat) }}</div>

          <div class="status-text typing" *ngIf="typingText; else defaultStatus">
            {{ typingText }}
          </div>
          <ng-template #defaultStatus>
            <div class="status-text">–≤ –º–µ—Ä–µ–∂—ñ</div>
          </ng-template>
        </div>
      </div>

      <div class="header-actions">
        <button class="action-btn">‚ãÆ</button>
      </div>
    </header>

    <section class="messages-box" #scrollBox>
      <div
        *ngFor="let msg of messages"
        class="message-container"
        [class.mine]="msg.senderId === userId"
      >
        <div class="message-group">
          <div class="bubble">
            {{ msg.content }}
            <div class="time">{{ msg.sentAt | date:'HH:mm' }}</div>
          </div>
        </div>
      </div>
    </section>

    <footer class="input-box">
      <div class="input-wrapper">
        <input
          [(ngModel)]="newMessage"
          (input)="onTyping()"
          (keydown.enter)="sendMessage()"
          placeholder="–ù–∞–ø–∏—Å–∞—Ç–∏ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è..."
        />
        <button class="send-btn" (click)="sendMessage()" [disabled]="!newMessage.trim()">
          <span class="send-icon">‚û§</span>
        </button>
      </div>
    </footer>
  </main>

  <ng-template #emptyState>
    <div class="empty-screen">
      <div class="empty-icon">üí¨</div>
      <h3>–í–∏–±–µ—Ä—ñ—Ç—å —á–∞—Ç, —â–æ–± –ø–æ—á–∞—Ç–∏ —Å–ø—ñ–ª–∫—É–≤–∞–Ω–Ω—è</h3>
    </div>
  </ng-template>
</div>
